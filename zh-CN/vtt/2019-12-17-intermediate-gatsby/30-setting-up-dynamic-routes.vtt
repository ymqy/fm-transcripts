WEBVTT

1
00:00:00.120 --> 00:00:04.234
杰森兰斯托夫: 查找网站，我们只是要步外纱工作区
&gt;&gt; Jason Lengstorf: The lookup site, we're
gonna just step outside of yarn workspaces

2
00:00:04.234 --> 00:00:06.849
完全没有，只是没有压力。
entirely and just not stress about them.

3
00:00:06.849 --> 00:00:10.619
所以我们要做的就是
So the way that this is gonna
work is we're going to start

4
00:00:10.619 --> 00:00:14.147
只要进入网站，让它运行起来。
by just getting into the site and
getting it running.

5
00:00:14.147 --> 00:00:20.230
所以让我们移动这个网站，如果我们看里面。
So let's get this site moving and
if we look inside.

6
00:00:20.230 --> 00:00:22.280
这里面真的很少。
There's really very little in here.

7
00:00:22.280 --> 00:00:25.440
我们添加了一些脚本，但是我们甚至还没有自己的依赖项。
We've got some scripts added, but
we don't even have our dependencies yet.

8
00:00:25.440 --> 00:00:28.464
那么，让我们开始吧。
So let's, move into it.

9
00:00:28.464 --> 00:00:34.801
我们要进入查找，然后我要纱加盖茨比反应-多姆。
We're gonna get into look up and then I'm
going to yarn add gatsby react react-dom.

10
00:00:38.585 --> 00:00:42.289
杰森 · 兰斯托夫: 好的，我们看到了盖茨比的反应和表演。
&gt;&gt; Jason Lengstorf: Okay, so we've got
gatsby react and react-dom in there.

11
00:00:42.289 --> 00:00:46.859
现在我要做的是，我要设置两个页面。
And now what I wanna do is
I wanna set up two pages.

12
00:00:46.859 --> 00:00:51.526
我想要一个索引页面，这将给我们提供我们的，就像我们的醒目页,
I want an index page and that's gonna give
us our, just kinda like our splash page,

13
00:00:51.526 --> 00:00:53.472
它会链接到搜索页面。
it will link over to a search page.

14
00:00:53.472 --> 00:00:55.810
而搜索页面就是这个应用实际上将要存在的地方。
And the search page is where
the app is actually gonna live.

15
00:00:56.890 --> 00:00:59.530
那么让我们开始吧。
So let's go ahead and get those started.

16
00:00:59.530 --> 00:01:06.606
因此，我们将从源文件夹、页面文件夹和 index.js 开始。
So we'll start with a source folder,
pages folder and index.js.

17
00:01:06.606 --> 00:01:10.623
所以我要导入反应，从反应和这个特定的网站,
So I'm gonna import react from react and
for this particular site,

18
00:01:10.623 --> 00:01:13.590
我们不用担心会不会弄得很漂亮。
we're not gonna worry
about making it look nice.

19
00:01:13.590 --> 00:01:16.480
我们要跳过界面，我们要跳过一般的造型和
We're gonna skip the UI,
we're gonna skip styling in general and

20
00:01:16.480 --> 00:01:20.780
只是把功能放在一起，因为我们今天花了很多时间在造型上
just put together the functionality cuz we
spent a lot of time on styling today and

21
00:01:20.780 --> 00:01:22.469
我不想再重复同样的话题。
I don't want to re-hash the same ground.

22
00:01:23.799 --> 00:01:27.810
所以让我们进口反应从反应,
So let's import react from react,

23
00:01:27.810 --> 00:01:32.930
我们要从盖茨比那里进口林克。
we're going to import link from gatsby.

24
00:01:34.060 --> 00:01:37.569
然后我们建立我们的索引页面。
And then we're gonna
set up our index page.

25
00:01:37.569 --> 00:01:42.578
所以我们的索引页面会很简洁明了。
And so our index page is going
to be nice and straightforward.

26
00:01:42.578 --> 00:01:46.444
我们将设置一个片段，这样就不会有任何额外的垃圾标记。
We will setup a fragment so
that we don't have any extra junky markup.

27
00:01:46.444 --> 00:01:52.370
我们会说这将是瑞克和莫蒂的角色抬头看。
We'll say this is gonna be the Rick and
Morty character look up.

28
00:01:52.370 --> 00:01:57.500
当我做这个的时候，我总觉得自己有点像个冒牌货。
I always feel like a little bit
of an impostor when I make this.

29
00:01:57.500 --> 00:01:58.956
每次我和这个 Rick 一起工作
Whenever I work with this Rick and

30
00:01:58.956 --> 00:02:02.192
因为我实际上只看过两集这个节目。
Morty API because I've actually only
ever seen two episodes of the show.

31
00:02:02.192 --> 00:02:06.590
但是我喜欢这个 API，因为它非常适合演示和
But I love this API because
it's perfect for demos and

32
00:02:06.590 --> 00:02:09.919
展示不同的事物是如何运作的。
showing off how different things work.

33
00:02:12.289 --> 00:02:18.063
好吧，我们要说
Okay, so we're gonna say

34
00:02:18.063 --> 00:02:24.364
我们来看看你最喜欢的
let's look up your favorite

35
00:02:24.364 --> 00:02:29.876
从里克和
characters from Rick and

36
00:02:29.876 --> 00:02:35.123
莫蒂利用瑞克和
Morty using the Rick and

37
00:02:35.123 --> 00:02:40.899
网站: Rick and
Morty.API.com Rick and

38
00:02:40.899 --> 00:02:43.533
Morty API.
Morty API.

39
00:02:43.533 --> 00:02:48.816
好，然后在这里我们只是要链接到搜索页面
Okay and then down here we're just
gonna link to the search page which

40
00:02:48.816 --> 00:02:53.659
我们需要创建，好吧，我认为这看起来像一页。
we'll need to create, okay and
I think that looks like a page.

41
00:02:53.659 --> 00:02:54.497
所以让我们出口它。
So let's export it.

42
00:03:00.484 --> 00:03:01.375
杰森 · 兰斯托夫: 好的
&gt;&gt; Jason Lengstorf: Okay, and

43
00:03:01.375 --> 00:03:04.590
然后我们创建-发言人2: 只是提醒一下,
then we'll create-
&gt;&gt; Speaker 2: Just a heads up,

44
00:03:04.590 --> 00:03:06.699
你在2号线漏了一句话。
you're missing a single quote on line two.

45
00:03:09.939 --> 00:03:11.840
杰森 · 兰斯托夫: 接得好。
&gt;&gt; Jason Lengstorf: Good catch.

46
00:03:11.840 --> 00:03:14.293
非常感谢。
Thank you very much.

47
00:03:14.293 --> 00:03:16.659
现在它是自动格式化的。
There it goes now it's auto formatting.

48
00:03:16.659 --> 00:03:18.060
太好了，谢谢。
Cool, thank you.

49
00:03:18.060 --> 00:03:23.294
所以我们有了我们的索引，然后在我们的搜索，我实际上只是
So we've got our index and
then in our search I'm actually just

50
00:03:23.294 --> 00:03:28.157
要采取大量的这一点，并投入正确的，我们会说。
gonna take a lot of this and
drop it right in and we'll say.

51
00:03:28.157 --> 00:03:32.139
搜索 Rick & Morty 字符和
Search for Rick &amp; Morty characters and

52
00:03:32.139 --> 00:03:37.449
然后我们可以说，给它一些有趣的市场复制品尝试
then we can say give it some
fun marketing copy trying

53
00:03:37.449 --> 00:03:42.530
记住你说的是哪个 Rick？
to remember which,
Rick you're talking about?

54
00:03:44.490 --> 00:03:50.800
试试这个方便的搜索界面，好吗。
Try out this handy search interface, okay.

55
00:03:50.800 --> 00:03:55.447
所以在这里，我们可以设置
So in here, we're gonna be able to set up

56
00:03:55.447 --> 00:04:00.370
一个真正的搜索界面但是现在,
an actual search interface but right now,

57
00:04:00.370 --> 00:04:06.110
我们没有一个，所以我们需要添加一个搜索表格
we don't have one so
we need to add a search form and

58
00:04:06.110 --> 00:04:09.847
我们需要增加结果，对吗？
we need to add results, right?

59
00:04:09.847 --> 00:04:15.629
所以在这里，让我们做到这一点
So here, let's make it so

60
00:04:15.629 --> 00:04:19.589
那种表情，我们知道我们希望我们的搜索结果在页面上显示。
that look, we know that we want our
search results to live on the page.

61
00:04:19.589 --> 00:04:21.220
所以让我们继续向上移动这个。
So let's go ahead and move this up.

62
00:04:21.220 --> 00:04:23.759
我打算用纱线显影。
And I'm just going to use yarn develop.

63
00:04:23.759 --> 00:04:26.670
因为我们不再使用主题，所以我们不再需要使用工作区。
Because again, we're not using themes so
we don't need to use workspaces anymore.

64
00:04:26.670 --> 00:04:30.759
我们可以直接进入并使用一个新的标准开发。
We can just jump right in and
use a new standard development.

65
00:04:30.759 --> 00:04:36.290
所以这里是我们高度风格的 Rick & Morty API 查找，让我放大一点点。
So here is our highly styled Rick &amp; Morty
API lookup, let me zoom in a little bit.

66
00:04:36.290 --> 00:04:40.720
当我点击我的搜索页面，我们可以看到我们的搜索页面。
And when I click over my search page,
we are able to see our search page.

67
00:04:40.720 --> 00:04:44.507
所以我们现在要做的，就是在搜索表格中添加
And so what we have to do yet,
is we have to add in our search form, and

68
00:04:44.507 --> 00:04:46.110
我们必须有结果。
we have to results.

69
00:04:46.110 --> 00:04:50.752
但是根据搜索结果我们希望有人搜索,
But with the results, the way that we want
this to work is when somebody searches,

70
00:04:50.752 --> 00:04:54.745
我们想让他们知道搜索的地点，比如说 Rick。
we wanted to show up where they're
going to search, let's say Rick.

71
00:04:54.745 --> 00:04:59.432
这样就可以重定向到搜索页面并显示结果,
And that should redirect to the search
page and show us results, and that way,

72
00:04:59.432 --> 00:05:02.415
如果我拿着这个复印一份然后发给别人,
if I take this, copy it,
and send it to somebody,

73
00:05:02.415 --> 00:05:04.920
他们应该能看到结果。
they should be able to see those results.

74
00:05:04.920 --> 00:05:08.560
你在搜索中遇到的一个主要问题是当你搜索到
One of the major problems that you
run into a search is when you have

75
00:05:08.560 --> 00:05:12.939
我在搜索栏里输入它会显示搜索结果页面，但是
a search field, I type into it It
shows me the results page, but

76
00:05:12.939 --> 00:05:14.779
网址上仍然只有搜索。
the URL still just says search.

77
00:05:14.779 --> 00:05:17.199
所以我没有办法和别人分享这些结果。
So I have no way of sharing
those results with somebody.

78
00:05:17.199 --> 00:05:20.889
所以如果我在电子商务网站上搜索
So if I'm looking for, like, if I'm on
an e-commerce site and I search for

79
00:05:20.889 --> 00:05:24.550
这就是我想要的生日礼物
a product and I go,
this is what I want for my birthday, and

80
00:05:24.550 --> 00:05:28.048
我想分享这个链接，嘿，你可以给我任何一个。
I want to share this link, hey,
you can give me any one of these.

81
00:05:29.209 --> 00:05:30.139
我不能告诉别人，对吧？
I can't share that, right?

82
00:05:30.139 --> 00:05:32.720
所以我拿不到生日礼物，大家都很伤心。
So I can't get my birthday present,
and everybody's sad.

83
00:05:32.720 --> 00:05:36.659
所以我们想让我们的搜索结果可链接。
So we wanna make our
search results linkable.

84
00:05:36.659 --> 00:05:41.540
为了做到这一点，您将利用《了不起的盖茨比》中的客户端路由。
And to do that, you will take advantage
of client-side routing in Gatsby.

85
00:05:42.699 --> 00:05:45.509
幸运的是，有一个 API 可以实现这个功能。
Which fortunately,
there's an API for that.

86
00:05:45.509 --> 00:05:53.329
所以在我们的根目录中，我们要创建一个 Gatsby node.js。
So in our root,
we're going to create a Gatsby node.js.

87
00:05:53.329 --> 00:05:58.728
在我们的盖茨比节点中，我们将要寻找
And in our Gatsby node,
we are going to look for

88
00:05:58.728 --> 00:06:01.507
创建页面 API。
the onCreatePage API.

89
00:06:01.507 --> 00:06:05.278
因此，每当创建一个新页面时，创建页面就会触发
And so onCreatePage fires whenever
a new page gets created and

90
00:06:05.278 --> 00:06:07.819
它允许我们在需要的时候修改它。
it allows us to modify it if we need to.

91
00:06:07.819 --> 00:06:09.720
有很多事情你可以调整。
There are a bunch of
things that you can tweak.

92
00:06:09.720 --> 00:06:15.139
具体来说，我们今天要做的就是寻找一条特定的道路。
Specifically, what we're going to do
today is look for a specific path.

93
00:06:15.139 --> 00:06:17.019
如果我们找到了,
And if we find it,

94
00:06:17.019 --> 00:06:21.779
我们要把它设置成动态的，就像客户端唯一的路线。
we're going to set it as a dynamic
like a client side only route.

95
00:06:21.779 --> 00:06:23.540
那么我们来设定一下,
So let's set up if,

96
00:06:23.540 --> 00:06:29.009
页面路径匹配，然后我们要使用我们的正则表达式。
the page path matches and then we're
gonna use our regular expression.

97
00:06:29.009 --> 00:06:30.899
每个人都喜欢用这种方式让自己陷入麻烦。
Everybody's favorite way to
get themselves in trouble.

98
00:06:32.029 --> 00:06:38.090
所以如果它以 / 搜索开始，我们知道我们在搜索页面上。
So if it starts with /search,
we know that we're on the search page.

99
00:06:38.090 --> 00:06:43.459
所以如果我们回来了，我们知道我们在我们想要的地方。
So if that comes back through,
we know that we are where we wanna be.

100
00:06:43.459 --> 00:06:48.550
然后我们要打电话给 matchpath 然后
So then,
we're gonna sat page.matchPath and

101
00:06:48.550 --> 00:06:51.769
我们要把它设置成博客搜索。
we are just gonna set it
to search with the blog.

102
00:06:51.769 --> 00:06:55.995
所以任何过去的事情
So anything that gets past this particular

103
00:06:55.995 --> 00:07:02.029
Url / 搜索可能会被当作是同一个页面。
URL/search will kinda get treated
as if it's all the same page.

104
00:07:02.029 --> 00:07:04.430
所有这些都会被重定向到搜索。
It will all get redirected to search.

105
00:07:06.319 --> 00:07:11.550
然后，我们只需要调用 createPage 和 tweak 页面。
Then, we just call createPage
with the tweak page.

106
00:07:11.550 --> 00:07:15.529
所以这只是覆盖了原创 createPage 的默认值。
So this just overrides the defaults
that were with the original createPage.

107
00:07:17.810 --> 00:07:20.839
所以，这只是故事的一半，因为我们已经让盖茨比这么做了
So, this is only half of the story though
because we've told Gatsby to do it which

108
00:07:20.839 --> 00:07:27.230
意味着盖茨比会尊重它但是如果我们刷新页面，如果我们得到链接
means that Gatsby will respect it But
if we refresh the page, if we get linked

109
00:07:27.230 --> 00:07:32.230
从别的地方，我们永远不可能去盖茨比酒店，看到那些东西被渲染出来。
from somewhere else, we would never get
to the gatsby for that to get rendered.

110
00:07:32.230 --> 00:07:37.529
所以接下来我们要做的就是设置一个重定向
So the next thing that we have to is
we have to set up a redirect and as

111
00:07:37.529 --> 00:07:43.319
一个捷径，否定有一个真正方便的 CLI，它会让你做一堆事情。
a shortcut, nullify has a really handy CLI
that will let you do a bunch of things.

112
00:07:43.319 --> 00:07:46.170
但最具体的是，它可以让您管理本地重定向。
But most specifically,
it'll let you manage redirects locally.

113
00:07:46.170 --> 00:07:48.449
所以我要开始准备了。
So I'm gonna go ahead and set that up.

114
00:07:48.449 --> 00:07:54.889
因此我们可以安装它与纱线全球添加 netlify-cli。
So we can install it with
yarn global add netlify-cli.

115
00:07:54.889 --> 00:08:01.108
然后在我的路线上，我要创建一个文件叫做。
And then in my route,
I'm gonna create a file called.

116
00:08:01.108 --> 00:08:06.788
我要创建一个叫 netlified.tamo 的文件
I'm gonna create a file
called netlified.tamo

117
00:08:06.788 --> 00:08:12.190
塔莫就像动物一样更容易迷惑兄弟姐妹,
Tamo is like animals
more confusing sibling,

118
00:08:12.190 --> 00:08:18.990
和它一起工作超级有趣，但我们就是这么用的。
and it's super fun to work with,
but this is how we use it.

119
00:08:20.040 --> 00:08:21.850
所以你设置了重定向,
So [LAUGH] you set up redirects,

120
00:08:21.850 --> 00:08:26.170
这是一个双数组，因为我想这意味着它像一个键，但
it's a double array because I guess
that means that it's Like a key but

121
00:08:26.170 --> 00:08:31.589
可以有多个实例的关键，所以，双数组。
there can be multiple instances
of that key, so, double array.

122
00:08:31.589 --> 00:08:38.519
然后我们设置从，它可以从任何搜索。
And then we setup from and
it can go from any search.

123
00:08:38.519 --> 00:08:39.889
所以任何搜索实例,
So any instance of search,

124
00:08:39.889 --> 00:08:45.259
它可以是 / search，然后是任意尾随字符数量。
it can be /search and
then any trailing amount of characters.

125
00:08:45.259 --> 00:08:49.470
然后我们要重定向到搜索。
And then we're gonna
redirect that to search.

126
00:08:49.470 --> 00:08:51.340
我们会发送一个状态码200,
And we're going to send
a status code of 200,

127
00:08:51.340 --> 00:08:55.029
所以是重写而不是重定向。
which makes it a rewrite
instead of a redirect.

128
00:08:55.029 --> 00:08:58.389
如果它是一个重定向，它将污染历史和
If it was a redirect,
it would pollute the history and

129
00:08:58.389 --> 00:09:01.029
有各种各样的麻烦，我们不想卷入。
there's all sorts of trouble
that we don't want to get into.

130
00:09:01.029 --> 00:09:03.629
所以我们只需要撒个弥天大谎。
So we're just gonna have netlify lie.

131
00:09:03.629 --> 00:09:08.350
假设这个重定向从未发生，你只是得到了这个页面。
And say that that redirect never
happened and you just got the page.

132
00:09:08.350 --> 00:09:13.379
这意味着我们现在可以打字了
So that means that we
should be able now to type

133
00:09:13.379 --> 00:09:17.850
在斜线搜索之后的任何东西，它会把我们带到搜索结果页面。
anything after slash search and it should
bring us to that search results page.

134
00:09:17.850 --> 00:09:20.230
为了测试它，我将使用 netlify dev。
To test it, I'm gonna use
something called netlify dev.

135
00:09:20.230 --> 00:09:23.250
现在我们已经安装了网络化 CLI,
So now that we've
installed that netlify CLI,

136
00:09:23.250 --> 00:09:28.519
我们有能力运行 netlify dev 来检测我们的 Gatsby 配置。
we have the ability to run netlify dev
which will detect our Gatsby config.

137
00:09:28.519 --> 00:09:32.309
然后在8888端口启动，而不是8000,
And then it starts up on
port 8888 instead of 8000,

138
00:09:32.309 --> 00:09:36.629
这是标准的 USB 端口，它将使我们的重定向工作，好吧。
which is the standard USB port, and
it will make our redirects work, okay.

139
00:09:36.629 --> 00:09:41.200
因此，使开发人员网络化的方法是根据其在场程度自动识别盖茨比
So the way that netlify dev works is it
auto detects Gatsby based on the presence

140
00:09:41.200 --> 00:09:42.210
档案。
of files.

141
00:09:42.210 --> 00:09:45.509
为了让它认出这是盖茨比的遗址,
And so to trick it into
recognizing this as a Gatsby site,

142
00:09:45.509 --> 00:09:48.159
我们要设置一个 Gatsby JS.config。
we're going to set up a Gatsby JS.config.

143
00:09:48.159 --> 00:09:53.139
然后我们可以运行 netlify 开发，它将运行 gatsby 开发。
And then we can run netlify dev,
and it will run gatsby develop.

144
00:09:53.139 --> 00:09:55.100
所以盖茨比配置不需要包含任何内容,
So the gatsby config doesn't
need to have anything in it,

145
00:09:55.100 --> 00:10:00.419
只需要让 netlify dev 意识到这是一个盖茨比的地盘。
it just needs to exist for netlify dev
to recognize that it's a gatsby site.

146
00:10:00.419 --> 00:10:04.230
现在在任何一个真正的网站上，你都会有一些盖茨比式的配置。
Now in any real site, you're gonna
have some kind of gatsby config.

147
00:10:04.230 --> 00:10:06.840
你将有网站元数据的搜索引擎优化。
You'll have site metadata for the SEO.

148
00:10:06.840 --> 00:10:08.220
你会得到类似的东西。
You'll have things like that.

149
00:10:08.220 --> 00:10:10.710
所以这并不是一件不合理的事情。
So that's not an unreasonable
thing to expect to exist.

150
00:10:12.409 --> 00:10:15.960
那么现在我们已经可以看到我们的搜索,
So now,
we can already see that our search,

151
00:10:17.070 --> 00:10:21.080
我可以把任何东西放在这里，但它还是会把我们带回到那个搜索页面。
I can put anything in here, and it's still
gonna take us back to that search page.

152
00:10:21.080 --> 00:10:25.889
如果我回来直接进行搜索，它仍然会显示搜索页面。
And if I come back and just go to straight
search, it still shows us the search page.

153
00:10:25.889 --> 00:10:33.190
所以在这一点上，我们得到的是一个功能性的客户端应用程序
So at this point, what we've got is a
functioning client side app that will take

154
00:10:33.190 --> 00:10:38.039
不管我们在搜索页面上放了什么，一定要把我们带到搜索部分。
whatever we throw at that search page, and
always bring us to that search component.

155
00:10:38.039 --> 00:10:41.639
这样我们就可以实际执行查找部分了。
And that sets us up to actually
do the the lookup part.

156
00:10:41.639 --> 00:10:47.691
因此，让我们保存我们的工作和
So let's save our work and

157
00:10:47.691 --> 00:10:55.951
然后我们再加上下一段。
then we'll add to that next piece.
